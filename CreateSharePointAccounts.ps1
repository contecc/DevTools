Import-Module ActiveDirectory -ErrorAction SilentlyContinue<#Requires the SharePoint OU to be created in Advance#>function createSPUser($name,$role,$domainRights,$sharePointSQLRights){Write-Host "Creating User $name" -ForegroundColor YellowNew-ADUser ` -Name $name ` -Path  "OU=SharePoint,DC=corp,DC=contoso,DC=com" ` -SamAccountName  $name ` -DisplayName $domainRights ` -Description $role ` -Office $sharePointSQLRights ` -AccountPassword (ConvertTo-SecureString "Password1$" -AsPlainText -Force) ` -ChangePasswordAtLogon $false ` -PasswordNeverExpires $true ` -Enabled $true}#SQL ServercreateSPUser "sqlInstall" "SQL Server Install Account" "Domain = Domain User" "SP=None;SQL= Local Admin on SQL Box"createSPUser "sqlUser" "Acccount SQL Instance is running as" "Domain = Domain User" "SP=None;SQL=Will be given perms when SQL is installed via a local Admin"createSPUser "spSuperReader" "Cache account" "Domain = Domain User" "SP = Web App Policy Full Read,Web App super reader account setting;SQL = None"createSPUser "spSuperUser" "Cache account" "Domain = Domain User" "SP = Web App Policy Full Control,Web App SuperAccount setting;SQL = none"createSPUser "spUserProfile" "UPA Account used to access AD" "Domain = Must have Replicating Change Perms to AD (ADUC/ADSIEDIT)" "SP = None;SQL = None"createSPUser "spContent" "Search Svc App Crawl Account" "Domain = Domain User" "SP = None; SQL = None"createSPUser "spServiceApps" "Service App Pool Id" "Domain = Domain User" "SP = None; SQL = None"createSPUser "spWebApp" "Content Web Apps Pool Id" "Domain = Domain User" "SP = None; SQL = None"createSPUser "spFarm" "Farm Account - Windows Timer Svc,Central Admin,UPA" "Domain = Domain User" "SP = Local Admin during UPS provisioning, log on locally right;SQL = none"createSPUser "spInstall" "installs SharePoint" "Domain = Domain User" "SP = Local Admin on SP Boxes; SQL = public, dbcreator, securityAdmin SQL Roles.  SysAdmin on SQL when installing Workflow mgr"createSPUser "sqlSaas" "SQL Svr Analysis Services" "Domain = Domain User" "SP = None; SQL db_datareader on databases"createSPUser "spExcel" "Excel svcs unattended account" "Domain = Domain User" "SP = None; SQL = None"createSPUser "spPPS" "PerformancePoint Unattended account" "Domain = Domain User" "SP = none; SQL = none"createSPUser "spAccess" "Access Svc. Used to create access databases in SQL and the svc account running svc app pool for Access Svc app" "Domain = Domain User" "SP = none; SQL = db_owner, public and securityAdmin"createSPUser "chris.conte.AD" "Admin Account used for Admin Operations" "Domain = DomainAdmin" "SP = Farm Admin; SQL = None"#Remove-ADUser spAccess -Confirm:$false